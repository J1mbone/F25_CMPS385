#include <iostream>
#include <string>
#include <iomanip>
using namespace std;

class Item {
private:
    string name;
    double price;

protected:
    Item(string n, double p) : name(n), price(p) {}

public:
    virtual ~Item() {}
    string getName() const { return name; }
    double getPriceVal() const { return price; }

    virtual void display() const = 0;
    virtual double getPrice() const = 0;
    virtual void receiptEntry() const = 0;
};

class FoodItem : public Item {
private:
    string expirationDate;

public:
    FoodItem(string n, double p, string exp)
        : Item(n, p), expirationDate(exp) {}

    void display() const override {
        cout << "Name: " << getName()
             << " | Price: $" << fixed << setprecision(2) << getPrice()
             << " | Exp: " << expirationDate << endl;
    }

    double getPrice() const override {
        return getPriceVal();
    }

    void receiptEntry() const override {
        cout << getName() << " - $" << fixed << setprecision(2) << getPrice() << endl;
    }
};

class ElectronicItem : public Item {
private:
    int warrantyMonths;

public:
    ElectronicItem(string n, double p, int w)
        : Item(n, p), warrantyMonths(w) {}

    void display() const override {
        cout << "Name: " << getName()
             << " | Price: $" << fixed << setprecision(2) << getPrice()
             << " | Warranty: " << warrantyMonths << " months" << endl;
    }

    double getPrice() const override {
        return getPriceVal();
    }

    void receiptEntry() const override {
        cout << getName() << " - $" << fixed << setprecision(2) << getPrice() << endl;
    }
};

int main() {
    const int MAX_ITEMS = 50;
    const int MAX_PURCHASES = 20;

    Item* store[MAX_ITEMS];
    Item* purchases[MAX_PURCHASES];
    int storeCount = 0, purchaseCount = 0;

    int choice;
    cout << "************* Welcome to QuickMart POS *************" << endl;

    do {
        cout << "1 - Add item to store" << endl;
        cout << "2 - Display available items" << endl;
        cout << "3 - Buy item by name" << endl;
        cout << "4 - View receipt" << endl;
        cout << "0 - Exit" << endl;
        cout << "Choice: ";
        cin >> choice;

        cin.ignore();

        if (choice == 1) {
            string type, name;
            double price;

            cout << "Enter item type (Food/Electronic): ";
            getline(cin, type);

            cout << "Enter item name: ";
            getline(cin, name);

            cout << "Enter price: ";
            cin >> price;
            cin.ignore();

            if (type == "Food" || type == "food") {
                string exp;
                cout << "Enter expiration date: ";
                getline(cin, exp);

                store[storeCount++] = new FoodItem(name, price, exp);
            } else if (type == "Electronic" || type == "electronic") {
                int warranty;
                cout << "Enter warranty in months: ";
                cin >> warranty;

                store[storeCount++] = new ElectronicItem(name, price, warranty);
            } else {
                cout << "Invalid item type!" << endl;
                continue;
            }

            cout << "Item added successfully!" << endl;

        } else if (choice == 2) {
            if (storeCount == 0) {
                cout << "No items in store." << endl;
            } else {
                for (int i = 0; i < storeCount; i++) {
                    store[i]->display();
                }
            }

        } else if (choice == 3) {
            string searchName;
            cout << "Enter item name: ";
            getline(cin, searchName);

            bool found = false;
            for (int i = 0; i < storeCount; i++) {
                if (store[i]->getName() == searchName) {
                    if (purchaseCount < MAX_PURCHASES) {
                        purchases[purchaseCount++] = store[i];
                        cout << "Purchased " << store[i]->getName()
                             << " for $" << fixed << setprecision(2)
                             << store[i]->getPrice() << endl;
                    }
                    found = true;
                    break;
                }
            }

            if (!found) {
                cout << "Item not found." << endl;
            }

        } else if (choice == 4) {
            if (purchaseCount == 0) {
                cout << "No purchases made yet." << endl;
            } else {
                double total = 0;
                cout << "---- Receipt ----" << endl;
                for (int i = 0; i < purchaseCount; i++) {
                    cout << (i + 1) << ". ";
                    purchases[i]->receiptEntry();
                    total += purchases[i]->getPrice();
                }
                cout << "Total: $" << fixed << setprecision(2) << total << endl;
            }
        }

    } while (choice != 0);

    cout << "Thank you for shopping at QuickMart!" << endl;

    // cleanup
    for (int i = 0; i < storeCount; i++) {
        delete store[i];
    }

    return 0;
}
